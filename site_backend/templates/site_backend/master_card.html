{% load djutils %}
{% load custom_filters %}

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>SB Admin 2 - Tables</title>

  <!-- Custom fonts for this template -->
  <link href="/static/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="/static/css/sb-admin-2.min.css" rel="stylesheet">

  <!-- Custom styles for this page -->
  <link href="/static/vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">

  <script type="text/javascript" src="jquery.dataTables.js"></script>


  <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
        $('#example').DataTable( {
            "order": [[ 3, "desc" ]]
        } );
    } );  
  </script>

</head>

<body id="page-top">
      <!-- Begin Page Content -->

      <!-- /.container-fluid -->
  <!-- USER info -->
  <div class="row">
    <!-- User card -->
    <div class="container col col-sm-12 col-md-6 col-xl-6 col-lg-6">
      <div class="card shadow mb-4">
        <div class="card-header">
          <!-- üëë –ï—Å–ª–∏ —ç–∫—Å–∫–ª—é–∑–∏–≤-->
            {% with info|get_value_from_dict:'user_data' as user_data %}
          <h2>–ö–∞—Ä—Ç–æ—á–∫–∞ {% if user_data.0|get_value_from_dict:'exclusive' %} üëë {% endif %} #{{ info|get_value_from_dict:'id' }}</h2>
        </div>
        <div class="card-body">
          <table class="table table-responsive">
            <thead>
              <tr>
                <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                <td>{{ user_data.0|get_value_from_dict:'reg_date' }}</td>
              </tr>
              <tr>
                <th>–§–ò–û</th>
                <td>{{ user_data.0|get_value_from_dict:'full_name' }}</td>
              </tr>
              <tr>
                <th>–ì–æ—Ä–æ–¥</th>
                <td>{{ info|get_value_from_dict:'city' }}</td>
              </tr>
              <tr>
                <th>–í–∏–¥—ã —Ä–∞–±–æ—Ç</th>
                <td>
                  <div class="btn-group">
                    <a class="dropdown-toggle text" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">–û—Ç–∫—Ä—ã—Ç—å</a>
                    <div class="dropdown-menu">
                      <label class="form-check-label">
                          {% for wt in info|get_value_from_dict:'work_types' %}
                              {{ wt|get_wt_name }}
                          {% endfor %}
                      </label>
                      </div>
                    </div>
                </td>
              </tr>
              <tr>
                <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                <td>{{ user_data.0|get_value_from_dict:'phone' }}</td>
              </tr>
              <tr>
                <th>–û—Ç–∫–ª–∏–∫–æ–≤ –Ω–∞ –∑–∞–∫–∞–∑—ã</th>
                <td>{{ info|get_value_from_dict:'deals_len' }}</td>
              </tr>
              <tr>
                <th>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –∑–∞–∫–∞–∑–æ–≤</th>
                <td>{{ info|get_value_from_dict:'proped_deals_ammount' }}</td>
              </tr>
            </thead>
          </table>
          <table class="table table-responsive">
            <thead>
              <tr>
                <th>–ö–∞–∫ –æ –Ω–∞—Å —É–∑–Ω–∞–ª&?</th>
                <td>{{ user_data.0|get_value_from_dict:'about_us' }}</td>
              </tr>
              <tr>
                <!-- –ï—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å -->
                {% if user_data.0|get_value_from_dict:'promo_id' %}
                    <th>–ü—Ä–æ–º–æ-–∫–æ–¥</th>
                    <td>
                      <a href="{% url "site_backend:master_card_url" user_data.0|get_value_from_dict:'promo_id' %}">{{user_data.0|get_value_from_dict:'promo_id'}}</a>
                    </td>
                {% endif %}
              </tr>         
              <tr>

                <th scope="row">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                <td>{{ user_data.0|get_value_from_dict:'comment' }}</td>
              </tr>
            </thead>
          </table>
        </div>
      </div>
    </div>
    <!--  Referal + session -->
    {% endwith %}
    <div class="container col col-sm-12 col-md-6 col-xl-6 col-lg-6">
      <!-- User referal -->
      <div class="card shadow mb-4">
        <div class="card-header">
          <!-- üëë –ï—Å–ª–∏ —ç–∫—Å–∫–ª—é–∑–∏–≤-->
          <h2>–†–µ—Ñ–µ—Ä–∞–ª—ã</h2>
        </div>

        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered table-striped" id='example' width="100%" cellspacing="0">
              <thead>
                <tr>
                  <!-- 
                    üí≥ / üíµ - –Ω–∞–ª/–±–µ–∑–Ω–∞–ª
                  -->
                  <th>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                  <th>–ö–æ–ª-–≤–æ —Å–¥–µ–ª–æ–∫</th>
                  <th>–ë–∞–ª–∞–Ω—Å</th>
                </tr>
              </thead>
              <tbody>
              {% for r in referal %}

                <tr>
                  <!-- https://tehpomosh.amocrm.ru/leads/detail/23363851 –ø—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ –ø–æ id —Å–¥–µ–ª–∫–∏-->
                  <td><a href="#">{{ r|get_value_from_dict:'id' }}</a></td>
                  <td> <a href="#">{{ r|get_value_from_dict:'deals_ammount' }}</a> </td>
                  <td>{{ r|get_value_from_dict:'balance' }}</td>
                </tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!-- User session history  -->
      <div class="card shadow mb-4">
        <div class="card-header">
          <!-- üëë –ï—Å–ª–∏ —ç–∫—Å–∫–ª—é–∑–∏–≤-->
          <h2>–ò—Å—Ç–æ—Ä–∏—è —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è </h2>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered"width="100%" cellspacing="0">
              <thead>
                <tr>
                  <!-- 
                    üí≥ / üíµ - –Ω–∞–ª/–±–µ–∑–Ω–∞–ª
                  -->
                  <th>–î–∞—Ç–∞</th>
                  <th>–ù–∞—á–∞–ª–æ</th>
                  <th>–ö–æ–Ω–µ—Ü</th>
                  <th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
                </tr>
              </thead>
              <tbody>
               {% with info|get_value_from_dict:'sessions' as sessions %}
                {% for s in sessions %}
                <tr>

                  <!-- https://tehpomosh.amocrm.ru/leads/detail/23363851 –ø—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ –ø–æ id —Å–¥–µ–ª–∫–∏-->
                  <th>{{ s|get_value_from_dict:'date' }}</th>
                  <th>{{ s|get_value_from_dict:'start_session' }}</th>
                  <th>{{ s|get_value_from_dict:'end_session' }}</th>
                  <th>{{ s|get_value_from_dict:'long_session' }}</th>
                </tr>
                {% endfor %}
              {% endwith %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Balance -->
  <div class="row">
    <div class="container col col-sm-12 col-md-6 col-xl-6 col-lg-6">
      <div class="card shadow mb-4">
        <div class="card-header">
          <!-- üëë –ï—Å–ª–∏ —ç–∫—Å–∫–ª—é–∑–∏–≤-->
            {% with info|get_value_from_dict:'user_data' as user_data %}
                <h2 class='text-center'>–ë–∞–ª–∞–Ω—Å {{ user_data.0|get_value_from_dict:'balance' }} ‚ÇΩ</h2>
            {% endwith %}
        </div>
        <div class="card-body">
          <div class="btn-group col">
            <button class="btn btn-success " type="submit">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button> 
            <button class="btn btn-danger "type="submit">–°–ø–∏—Å–∞—Ç—å</button> 
          </div>
        </div>
      </div>
    </div>
    <div class="container col col-sm-12 col-md-6 col-xl-6 col-lg-6">
      <div class="card shadow mb-4">
        <div class="card-header">
          <!-- üëë –ï—Å–ª–∏ —ç–∫—Å–∫–ª—é–∑–∏–≤-->
          <h2>–ò—Å—Ç–æ—Ä–∏—è –±–∞–ª–∞–Ω—Å–∞</h2>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered" width="100%" cellspacing="0">
              <thead>
                <tr>
                  <th>–°—É–º–º–∞</th>
                  <th>–î–∞—Ç–∞</th>
                  <th data-toggle="tooltip" data-placement="right" title="–ù–∞ –º–æ–º–µ–Ω—Ç —Å–¥–µ–ª–∫–∏">–ë–∞–ª–∞–Ω—Å</th>
                  <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
              </thead>

              <tbody>
              {% with info|get_value_from_dict:'transfers' as transfers %}
                {% for t in transfers %}
                <tr>
                  <th>{{t|get_value_from_dict:'ammount'}}</th>
                  <th>{{t|get_value_from_dict:'date'}}</th>
                  <th>{{t|get_value_from_dict:'balance'}}</th>
                  <th>{{t|get_value_from_dict:'comment'}}</th>
                </tr>
               {% endfor %}
              {% endwith %}
              </tbody>
            </table>
          </div>
          
        </div>
      </div>
    </div>
  </div>
    <!-- Deals history -->
  <div class="row">
      <div class="card shadow col">
        <div class="card-header">
          <h2>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
              <thead>
                <tr>
                  <!-- 
                    üí≥ / üíµ - –Ω–∞–ª/–±–µ–∑–Ω–∞–ª
                  -->
                  <th>–î–∞—Ç–∞</th>
                  <th>ID —Å–¥–µ–ª–∫–∏</th>
                  <th>–¢–∏–ø</th>
                  <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                  <th>–¶–µ–Ω–∞ –æ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</th>
                  <th>–ù–∞—à–∞ –∫–æ–º–º–∏—Å—Å–∏—è</th>
                  <th>–ó–∞—á–∏—Å–ª–µ–Ω–æ</th>
                  <th>–ü–∞—Ä—Ç–Ω–µ—Ä</th>
                  <th>–°—Ç–∞—Ç—É—Å</th>
                  <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                </tr>
              </thead>
              <tbody>
              {% with info|get_value_from_dict:'deals' as deals %}
              {% for deal in deals %}

                <tr>
                  <!-- https://tehpomosh.amocrm.ru/leads/detail/23363851 –ø—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ –ø–æ id —Å–¥–µ–ª–∫–∏-->
                  <td>{{ deal|get_value_from_dict:'date' }}</td>
                  <td>{{ deal|get_value_from_dict:'id' }}</td>

                  <td class=" text-center" data-toggle="tooltip" data-placement="right" title="üí≥ - –ë–ï–ó–Ω–∞–ª–∏—á–Ω—ã–µ/üíµ- –Ω–∞–ª–∏—á–Ω—ã–µ">{% if deal|get_value_from_dict:'self_employeed' %}üí≥{% else %}üíµ{% endif %}</td>
                  <td>{{ deal|get_value_from_dict:'commission_precent' }}%</td>
                  <td >{{ deal|get_value_from_dict:'value' }} ‚ÇΩ</td>
                {% with  value=deal|get_value_from_dict:'value' percent=deal|get_value_from_dict:'commission_precent' %}
                  <td class="text-success">{{ value|count_percent:percent }} ‚ÇΩ</td>
                  <td class="text-danger">{{ value|count_user_percent:percent }} ‚ÇΩ</td>
                {% endwith %}
                  <td> {% if deal|get_value_from_dict:'id_proped' %}<a href="{% url "site_backedn:master_card_url" deal|get_value_from_dict:'id_proped' %}">{{deal|get_value_from_dict:'id_proped'}}</a> {% else %} - {% endif %}</td>
                  <td class=" text-center" >
                    <div class="btn-group">
                      <button class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">–û–ø–ª–∞—á–µ–Ω–æ</button>
                      <div class="dropdown-menu">
                        <button class="btn bg-info text-white dropdown-item" >–°–ø–∏—Å–∞—Ç—å</button>
                        <button class="btn bg-warning text-white dropdown-item" >–í–µ—Ä–Ω—É—Ç—å</button>
                      </div>
                    </div>
                  </td>
                  <td> {% if deal|get_value_from_dict:'comment' %}{{deal|get_value_from_dict:'comment'}} {% else %} - {% endif %}</td>
                </tr>
                <tr>
                                  {% endfor %}
              {% endwith %}
                  <!-- https://tehpomosh.amocrm.ru/leads/detail/23363851 –ø—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ –ø–æ id —Å–¥–µ–ª–∫–∏-->
                  <td>22.14.2019</td>
                  <td> <a href="#">999999</a> </td>
                  <td class=" text-center" data-toggle="tooltip" data-placement="right" title="üí≥ - –ë–ï–ó–Ω–∞–ª–∏—á–Ω—ã–µ/üíµ- –Ω–∞–ª–∏—á–Ω—ã–µ">üí≥</td>
                  <td>40%</td>
                  <td >2000 ‚ÇΩ</td>
                  <td class="text-success">10000 ‚ÇΩ</td>
                  <td class="text-danger">100 ‚ÇΩ</td>
                  <td></td>
                  <td class=" text-center">
                    <div class="btn-group">
                      <button class="btn btn-danger dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">–°–æ—Ä–≤–∞–Ω–æ</button>
                      <div class="dropdown-menu">
                        <button class="btn bg-info text-white dropdown-item" >–°–ø–∏—Å–∞—Ç—å</button>
                        <button class="btn bg-warning text-white dropdown-item" >–í–µ—Ä–Ω—É—Ç—å</button>
                      </div>
                    </div>
                  </td>

                  <td><a href="#"></a></td>
                </tr>
                <tr>
                  <!-- https://tehpomosh.amocrm.ru/leads/detail/23363851 –ø—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ –ø–æ id —Å–¥–µ–ª–∫–∏-->
                  <td>22.14.2019</td>
                  <td> <a href="#">999999</a> </td>
                  <td class=" text-center" data-toggle="tooltip" data-placement="right" title="üí≥ - –ë–ï–ó–Ω–∞–ª–∏—á–Ω—ã–µ/üíµ- –Ω–∞–ª–∏—á–Ω—ã–µ">üíµ</td>
                  <td>40%</td>
                  <td >2000 ‚ÇΩ</td>
                  <td class="text-success">10000 ‚ÇΩ</td>
                  <td class="text-danger">100 ‚ÇΩ</td>
                  <td><a href="#">999999</a></td>
                  <td class='text-warning text-center font-weight-bold'>–í —Ä–∞–±–æ—Ç–µ
     
                  </td>

                  <td><a href="#"></a></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
  </div>
  <!-- End of Page Wrapper -->

  <!-- Bootstrap core JavaScript-->
  <script src="/static/vendor/jquery/jquery.min.js"></script>
  <script src="/static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Core plugin JavaScript-->
  <script src="/static/vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Custom scripts for all pages-->
  <script src="/static/js/sb-admin-2.min.js"></script>

  <!-- Page level plugins -->
  <script src="/static/vendor/datatables/jquery.dataTables.min.js"></script>
  <script src="/static/vendor/datatables/dataTables.bootstrap4.min.js"></script>

  <!-- Page level custom scripts -->
  <script src="/static/js/demo/datatables-demo.js"></script>

</body>

</html>
